<!doctype html>
<html lang="en">

<head>
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-131452110-2"></script>
  <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-131452110-2');
  </script>
  <!-- Required Meta Tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>windowsforensics.net</title>
  <meta name="description" content="Firefox and IE has a built-in download manager application which keeps a history of every file downloaded by the user.">
  <link rel="shortcut icon" href="../../img/puzzle.svg" type="image/x-icon">
  <!-- CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
    integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
  <link rel="stylesheet" href="../../css/styles.css">
</head>

<body>
  <!-- Navigation Bar -->
  <nav class="navbar navbar-expand-lg  navbar-dark bg-dark">
    <div class="container-fluid">
      <!-- Brand -->
      <a class="navbar-brand" href='https://www.windowsforensics.net'>
        <i class="icon-white">
          <svg class="bi bi-puzzle-fill" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor"
            xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd"
              d="M3.112 3.645A1.5 1.5 0 014.605 2H7a.5.5 0 01.5.5v.382c0 .696-.497 1.182-.872 1.469a.459.459 0 00-.115.118.113.113 0 00-.012.025L6.5 4.5v.003l.003.01c.004.01.014.028.036.053a.86.86 0 00.27.194C7.09 4.9 7.51 5 8 5c.492 0 .912-.1 1.19-.24a.86.86 0 00.271-.194.213.213 0 00.036-.054l.003-.01v-.008a.112.112 0 00-.012-.025.459.459 0 00-.115-.118c-.375-.287-.872-.773-.872-1.469V2.5A.5.5 0 019 2h2.395a1.5 1.5 0 011.493 1.645L12.645 6.5h.237c.195 0 .42-.147.675-.48.21-.274.528-.52.943-.52.568 0 .947.447 1.154.862C15.877 6.807 16 7.387 16 8s-.123 1.193-.346 1.638c-.207.415-.586.862-1.154.862-.415 0-.733-.246-.943-.52-.255-.333-.48-.48-.675-.48h-.237l.243 2.855A1.5 1.5 0 0111.395 14H9a.5.5 0 01-.5-.5v-.382c0-.696.497-1.182.872-1.469a.459.459 0 00.115-.118.113.113 0 00.012-.025L9.5 11.5v-.003l-.003-.01a.214.214 0 00-.036-.053.859.859 0 00-.27-.194C8.91 11.1 8.49 11 8 11c-.491 0-.912.1-1.19.24a.859.859 0 00-.271.194.214.214 0 00-.036.054l-.003.01v.002l.001.006a.113.113 0 00.012.025c.016.027.05.068.115.118.375.287.872.773.872 1.469v.382a.5.5 0 01-.5.5H4.605a1.5 1.5 0 01-1.493-1.645L3.356 9.5h-.238c-.195 0-.42.147-.675.48-.21.274-.528.52-.943.52-.568 0-.947-.447-1.154-.862C.123 9.193 0 8.613 0 8s.123-1.193.346-1.638C.553 5.947.932 5.5 1.5 5.5c.415 0 .733.246.943.52.255.333.48.48.675.48h.238l-.244-2.855z"
              clip-rule="evenodd" />
          </svg>
        </i> WINDOWSFORENSICS
      </a>
      <!-- Collapsable Toggle Button -->
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar"
        aria-controls="collapsibleNavbar" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <!-- Links -->
      <div class="collapse navbar-collapse" id="collapsibleNavbar">
        <div class="navbar-nav ml-auto">
          <a class="nav-item nav-link" href="../../index.html">Home</a>
          <a class="nav-item nav-link active" href="database.html">Database<span class="sr-only">(current)</span></a>
          <a class="nav-item nav-link" href="workshops.html">Workshops</a>
          <a class="nav-item nav-link" href="about.html">About</a>
        </div>
      </div>
    </div>
  </nav>

  <div class="container-fluid">
    <div class="row content">
      <!-- Navigation Sidebar -->
      <div class="col-lg-2 text-left"></div>

      <!-- Web Page Content -->
      <div class="col-lg-8 text-left">
        <br>
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="../../database.html">Database</a></li>
            <li class="breadcrumb-item"><a href="file-download.html">File Download</a></li>
            <li class="breadcrumb-item active" aria-current="page">Downloads</li>
          </ol>
        </nav>
        <div class="database">
          <h1>Downloads</h1>
          <p><strong>Description</strong>: Firefox and IE have built-in download manager applications which keep a
            history of every file downloaded by the user. Although Google Chrome doesn't have a seperate download manager, the structure of their history database makes it simple to track file downloads. These browser artifacts can provide excellent information
            about
            what sites a user has been visiting and what kinds of files they have been downloading from them.</p>
          <p><strong>Location</strong>:<br>
            Firefox:</p>
          <ul>
            <li>Firefox 3 - 25:<ul>
                <li>C:\Users\&lt;username&gt;\AppData\Roaming\Mozilla\Firefox\Profiles\&lt;random
                  text&gt;.default\downloads.sqlite</li>
              </ul>
            </li>
            <li>Firefox 26+:<ul>
                <li>C:\Users\&lt;username&gt;\AppData\Roaming\Mozilla\Firefox\Profiles\&lt;random
                  text&gt;.default\places.sqlite</li>
              </ul>
            </li>
          </ul>
          <p>Internet Explorer:</p>
          <ul>
            <li>Internet Explorer 8 - 9:<ul>
                <li>C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Windows\IEDownloadHistory\</li>
              </ul>
            </li>
            <li>Internet Explorer 10 - 11:<ul>
                <li>C:\Users\&lt;username&gt;\AppData\Local\Microsoft\Windows\WebCache\WebCacheV*.dat</li>
              </ul>
            </li>
          </ul>
          <p>Chrome</p>
          <ul>
            <li>C:\Users\&lt;username&gt;\AppData\Local\Google\Chrome\User Data\Default\History</li>
          </ul>
          <p><strong>Notes</strong>: Depending on the web browser you are analyzing, download managers may include a
            wealth of information assciated with a file download:
            <ul>
              <li>File Name, File Size, File Type, and the File Save Location</li>
              <li>Download URL and HTTP Referer URL</li>
              <li>Download Start and End Times</li>
            </ul>
            <p><strong>Analysis</strong>: Modern web browsers store data related to
              browsing history within databases located on the local file system. We can reference these databases to learn about a users browsing habits. 
              <br>
              <br>
              Firefox stores it's browser information inside of SQLite databases. We can use <a
                href="https://sqlitebrowser.org/">DB Browser for SQLite</a> to open the databases and review their
              structure. I'm running Firefox 75 so my download history is stored within the
              <strong>places.sqlite</strong> database. To review my download history, let's load my places.sqlite
              database within DB Browser for SQLite and take note of following tables that contain information related
              to download history: moz_anno_attributes, moz_annos, and moz_places.
              <br>
              <br>
              <img src="../../img/downloads-firefox-database-structure.png" class="img-fluid">
              <br>
              <br>
              Navigate to <strong>Browse Data</strong> and select <strong>moz_anno_attributes</strong> from the table
              dropdown. The id describes the meta-data captured by the next table: moz_annos.
              <br>
              <br>
              <img src="../../img/downloads-firefox-mox-anno-attributes.png" class="img-fluid">
              <br>
              <br>
              Select <strong>moz_annos</strong> from the table dropdown. The meta-data referenced by moz_anno_attributes
              can be seen in the content column. This table identifies the file name, file size, file type and the
              directory the file was downloaded too. To continue the analysis, notate the decimal value of
              <strong>place_id</strong> and select <strong>moz_places</strong> from the table down. Search for the id
              referenced in the previous dataset to find even more data related to the file download, including the
              download url, website title, file host, and vist count of the referenced site.
              <br>
              <br>
              <img src="../../img/downloads-firefox-browse-data.gif" class="img-fluid">
              <br>
              <br>
              Google Chrome also stores it's browsing history within an SQLite database and perhaps unsurprisingly it's one of easiest web browsers to analyze in addition to boasting one of the most complete data-set. Simply load Google Chrome's <strong>History</strong> database within DB Browser for SQLite and select <strong>downloads</strong> from the table dropdown. This database contains almost every piece of meta-data you could ask for when analyzing browsing history.
              <br>
              <br>
              <img src="../../img/downloads-chrome-sqlite-downloads.png" class="img-fluid">
              <br>
              <br>
              The versions of Internet Explorer that you are most likely to encounter, IE 10 - 11, store their browser information inside of an ESE database. Unfortunately, the database isn't structured in a way that makes it easy to navigate with a tool like Nirsoft's <a href="https://www.nirsoft.net/utils/ese_database_view.html">ESEDatabaseView</a>. Instead I found it simplier to rely on another Nirsoft utility: <a href="https://www.nirsoft.net/utils/browsing_history_view.html">BrowsingHistoryView</a> to parse the data found within WebCacheV01.dat. 
              <br>
              <br>
              Using BrowsingHistoryView, we can analyze the WebCacheV01.dat file. Unfortunatly even with this utility organizing the ESE database, there are still a number of key meta-data fields missing from our output that assist us with identifying file downloads, specifically the <strong>Visit Type</strong> field that would normally notate downloads. We may still be able to spot file downloads by reviewing the <strong>URL</strong> but we can't identify it as quickly as we could if downloads were properly notated.
              <br>
              <br>
              <img src="../../img/downloads-browsinghistoryview-ie.png" class="img-fluid">
              <br>
              <br>
              To illistrate the ideal output for BrowsingHistoryView, lets compare our previous results with the same Firefox SQLite database we analyzed manually earlier. Notice how the value of <strong>Visit Type</strong> is Download. We can utilize that field to quickly filter for only Downloaded files, improving the speed of our investigation.
              <br>
              <br>
              <img src="../../img/downloads-browsinghistoryview-firefox.png" class="img-fluid">
              <br>
              <br>
            </p>
        </div>
      </div>
      <div class="col-lg-2 text-left"></div>
    </div>
  </div>
  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
    integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
    integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
    crossorigin="anonymous"></script>

</body>

</html>