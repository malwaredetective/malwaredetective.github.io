<!doctype html>
<html lang="en">

<head>
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-131452110-2"></script>
  <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-131452110-2');
  </script>
  <!-- Required Meta Tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>windowsforensics.net</title>
  <meta name="description" content="Track internal and external Remote Desktop Protocol connections.">
  <link rel="shortcut icon" href="../../img/puzzle.svg" type="image/x-icon">
  <!-- CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
    integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
  <link rel="stylesheet" href="../../css/styles.css">
</head>

<body>
  <!-- Navigation Bar -->
  <nav class="navbar navbar-expand-lg  navbar-dark bg-dark">
    <div class="container-fluid">
      <!-- Brand -->
      <a class="navbar-brand" href='https://windowsforensics.net'>
        <i class="icon-white">
          <svg class="bi bi-puzzle-fill" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor"
            xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd"
              d="M3.112 3.645A1.5 1.5 0 014.605 2H7a.5.5 0 01.5.5v.382c0 .696-.497 1.182-.872 1.469a.459.459 0 00-.115.118.113.113 0 00-.012.025L6.5 4.5v.003l.003.01c.004.01.014.028.036.053a.86.86 0 00.27.194C7.09 4.9 7.51 5 8 5c.492 0 .912-.1 1.19-.24a.86.86 0 00.271-.194.213.213 0 00.036-.054l.003-.01v-.008a.112.112 0 00-.012-.025.459.459 0 00-.115-.118c-.375-.287-.872-.773-.872-1.469V2.5A.5.5 0 019 2h2.395a1.5 1.5 0 011.493 1.645L12.645 6.5h.237c.195 0 .42-.147.675-.48.21-.274.528-.52.943-.52.568 0 .947.447 1.154.862C15.877 6.807 16 7.387 16 8s-.123 1.193-.346 1.638c-.207.415-.586.862-1.154.862-.415 0-.733-.246-.943-.52-.255-.333-.48-.48-.675-.48h-.237l.243 2.855A1.5 1.5 0 0111.395 14H9a.5.5 0 01-.5-.5v-.382c0-.696.497-1.182.872-1.469a.459.459 0 00.115-.118.113.113 0 00.012-.025L9.5 11.5v-.003l-.003-.01a.214.214 0 00-.036-.053.859.859 0 00-.27-.194C8.91 11.1 8.49 11 8 11c-.491 0-.912.1-1.19.24a.859.859 0 00-.271.194.214.214 0 00-.036.054l-.003.01v.002l.001.006a.113.113 0 00.012.025c.016.027.05.068.115.118.375.287.872.773.872 1.469v.382a.5.5 0 01-.5.5H4.605a1.5 1.5 0 01-1.493-1.645L3.356 9.5h-.238c-.195 0-.42.147-.675.48-.21.274-.528.52-.943.52-.568 0-.947-.447-1.154-.862C.123 9.193 0 8.613 0 8s.123-1.193.346-1.638C.553 5.947.932 5.5 1.5 5.5c.415 0 .733.246.943.52.255.333.48.48.675.48h.238l-.244-2.855z"
              clip-rule="evenodd" />
          </svg>
        </i> WINDOWSFORENSICS
      </a>
      <!-- Collapsable Toggle Button -->
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar"
        aria-controls="collapsibleNavbar" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <!-- Links -->
      <div class="collapse navbar-collapse" id="collapsibleNavbar">
        <div class="navbar-nav ml-auto">
          <a class="nav-item nav-link" href="https://windowsforensics.net/index.html">Home</a>
          <a class="nav-item nav-link active" href="https://windowsforensics.net/database.html">Database<span class="sr-only">(current)</span></a>
          <a class="nav-item nav-link" href="https://windowsforensics.net/workshops.html">Workshops</a>
          <a class="nav-item nav-link" href="https://windowsforensics.net/about.html">About</a>
        </div>
      </div>
    </div>
  </nav>

  <div class="container-fluid">
    <div class="row content">
      <!-- Navigation Sidebar -->
      <div class="col-lg-2 text-left"></div>

      <!-- Web Page Content -->
      <div class="col-lg-8 text-left">
        <br>
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="../../database.html">Database</a></li>
            <li class="breadcrumb-item"><a href="account-usage.html">Account Usage</a></li>
            <li class="breadcrumb-item active" aria-current="page">RDP Usage</li>
          </ol>
        </nav>
        <div class="database">
          <h1>RDP Usage</h1>
          <p><strong>Description</strong>: Track internal and external Remote Desktop Protocol connections.</p>
          <p><strong>Location</strong>:</p>
          <ul>
            <li>C:\Windows\System32\winevt\logs\Security.evtx</li>
            <li>
              C:\Windows\System32\winevt\logs\Microsoft-Windows-TerminalServices-RemoteConnectionManager%4Operational.evtx
            </li>
          </ul>
          <p><strong>Notes</strong>: The Security.evtx log can be used to track outgoing RDP connections:</p>
          <ul>
            <li>Event ID: <a
                href="https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=4624">4624</a>
              - Logon Type 10</li>
            <li>Event ID: <a
                href="https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=4778">4778</a>
              - Session Connected/Reconnected</li>
            <li>Event ID: <a
                href="https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=4779">4779</a>
              - Session Disconnected</li>
          </ul>
          <p>The Microsoft-Windows-TerminalServices-RemoteConnectionManager%4Operational.evtx log can be used to track
            incoming RDP connections:</p>
          <ul>
            <li>Event ID: <a
                href="https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=1149">1149</a>
              - <em>Network</em> Authentication Succeeded</li>
          </ul>
          <p><strong>Analysis</strong>: Attackers often use legitmate Windows tools to laterally traverse throughout an
            enviornment. As a result, it's important to understand the forensic artifacts associted with RDP. There are
            multiple Windows Event ID's associated with RDP and we often have to reference multiple logs to map out the
            full picture.
            <br>
            <br>
            We can use Windows native Event Viewer application for analyzing .evtx files. On a Windows client,
            double-clicking an .evtx file will automatically open the log inside of the <strong>Saved Logs</strong>
            folder in Event Viewer.
            <br>
            <br>
            <img src="../../img/event-viewer.png" class="img-fluid">
            <br>
            <br>
            To filter for a specific event, select <strong>Filter Current Log...</strong> to pull up a dialog box with
            filtering option and input the Event ID you'd like to isolate.
            <br>
            <br>
            <img src="../../img/event-viewer-filter-current-log.gif" class="img-fluid">
            <br>
            <br>
            I don't currently have any examples of Remote Desktop to showcase, but I'm working on setting up a small
            Windows environment for an upcoming Windows Forensics workshop and will capture some examples of RDP. For
            some additional reading on RDP, I recommend you check out this <a
              href="https://www.13cubed.com/downloads/rdp_flowchart.pdf">Flowchart</a> created by <a
              href="https://www.13cubed.com/">13cubed</a>, who is an excellent resource within the DFIR community.
            <br>
            <br>
          </p>
        </div>
      </div>
      <div class="col-lg-2 text-left"></div>
    </div>
  </div>
  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
    integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
    integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
    crossorigin="anonymous"></script>

</body>

</html>