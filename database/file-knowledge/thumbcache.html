<!doctype html>
<html lang="en">

<head>
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-131452110-2"></script>
  <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-131452110-2');
  </script>
  <!-- Required Meta Tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>windowsforensics.net</title>
  <meta name="description" content="Hidden file in directory where images on machine exist stored in a smaller thumbnail graphic.">
  <link rel="shortcut icon" href="../../img/puzzle.svg" type="image/x-icon">
  <!-- CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
    integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
  <link rel="stylesheet" href="../../css/styles.css">
</head>

<body>
  <!-- Navigation Bar -->
  <nav class="navbar navbar-expand-lg  navbar-dark bg-dark">
    <div class="container-fluid">
      <!-- Brand -->
      <a class="navbar-brand" href='https://www.windowsforensics.net'>
        <i class="icon-white">
          <svg class="bi bi-puzzle-fill" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor"
            xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd"
              d="M3.112 3.645A1.5 1.5 0 014.605 2H7a.5.5 0 01.5.5v.382c0 .696-.497 1.182-.872 1.469a.459.459 0 00-.115.118.113.113 0 00-.012.025L6.5 4.5v.003l.003.01c.004.01.014.028.036.053a.86.86 0 00.27.194C7.09 4.9 7.51 5 8 5c.492 0 .912-.1 1.19-.24a.86.86 0 00.271-.194.213.213 0 00.036-.054l.003-.01v-.008a.112.112 0 00-.012-.025.459.459 0 00-.115-.118c-.375-.287-.872-.773-.872-1.469V2.5A.5.5 0 019 2h2.395a1.5 1.5 0 011.493 1.645L12.645 6.5h.237c.195 0 .42-.147.675-.48.21-.274.528-.52.943-.52.568 0 .947.447 1.154.862C15.877 6.807 16 7.387 16 8s-.123 1.193-.346 1.638c-.207.415-.586.862-1.154.862-.415 0-.733-.246-.943-.52-.255-.333-.48-.48-.675-.48h-.237l.243 2.855A1.5 1.5 0 0111.395 14H9a.5.5 0 01-.5-.5v-.382c0-.696.497-1.182.872-1.469a.459.459 0 00.115-.118.113.113 0 00.012-.025L9.5 11.5v-.003l-.003-.01a.214.214 0 00-.036-.053.859.859 0 00-.27-.194C8.91 11.1 8.49 11 8 11c-.491 0-.912.1-1.19.24a.859.859 0 00-.271.194.214.214 0 00-.036.054l-.003.01v.002l.001.006a.113.113 0 00.012.025c.016.027.05.068.115.118.375.287.872.773.872 1.469v.382a.5.5 0 01-.5.5H4.605a1.5 1.5 0 01-1.493-1.645L3.356 9.5h-.238c-.195 0-.42.147-.675.48-.21.274-.528.52-.943.52-.568 0-.947-.447-1.154-.862C.123 9.193 0 8.613 0 8s.123-1.193.346-1.638C.553 5.947.932 5.5 1.5 5.5c.415 0 .733.246.943.52.255.333.48.48.675.48h.238l-.244-2.855z"
              clip-rule="evenodd" />
          </svg>
        </i> WINDOWSFORENSICS
      </a>
      <!-- Collapsable Toggle Button -->
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar"
        aria-controls="collapsibleNavbar" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <!-- Links -->
      <div class="collapse navbar-collapse" id="collapsibleNavbar">
        <div class="navbar-nav ml-auto">
          <a class="nav-item nav-link" href="../../index.html">Home</a>
          <a class="nav-item nav-link active" href="database.html">Database<span class="sr-only">(current)</span></a>
          <a class="nav-item nav-link" href="workshops.html">Workshops</a>
          <a class="nav-item nav-link" href="about.html">About</a>
        </div>
      </div>
    </div>
  </nav>

  <div class="container-fluid">
    <div class="row content">
      <!-- Navigation Sidebar -->
      <div class="col-lg-2 text-left"></div>

      <!-- Web Page Content -->
      <div class="col-lg-8 text-left">
        <br>
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="../../database.html">Database</a></li>
            <li class="breadcrumb-item"><a href="file-knowledge.html">File Knowledge</a></li>
            <li class="breadcrumb-item active" aria-current="page">Thumbcache</li>
          </ol>
        </nav>
        <div class="database">
          <h1>Thumbcache</h1>
          <p><strong>Description</strong>: Thumbnails of pictures, office documents, and folders exist in multiple databases
            known as thumbcache. Each user will have their own set of databases. The databaes are based on the thumbnail sizes viewed by the
            user.</p>
          <p><strong>Location</strong>:</p>
          <ul>
            <li>C:\Users\&lt;username&gt;\AppData\Local\Microsoft\Windows\Explorer</li>
          </ul>
          <p><strong>Notes</strong>:
            These are created when a user switches a folder to thumbnail mode or views pictures via a slide show. As it
            were, our thumbs are now stored in separate database files. The Thumbcache will store the thumbnail copy of
            the picture based on the thumbnail size in the content of
            the equivalent database file.</p>

          <p><strong>Analysis</strong>: Depending on the Operating System you are analzying, you many encounter
            different size formats of thumbcache databases. When thumbcaches were first introduced with Windows 7, only
            small, medium, large and extra large thumbnails were cached. Now on Windows 10, there are upwards
            to 15 different size formats for thumbcache databases. Windows 8 and Windows 10 also introduced a new
            database known as <strong>iconcache</strong>, which follows a similar purpuse as thumbcache but for icons.
            <br>
            <br>
            <img src="../../img/thumbcache-explorer.png" class="img-fluid">
            <br>
            <br>
            We can analyze these databases with <a href="https://thumbcacheviewer.github.io/">Thumbcache Viewer</a>, a GUI
            application created by Eric Kutcher. You can load one or more databases into Thumbcache Viewer for analysis. An image of the selected file will be displayed in a second window. 
            <br>
            <br>
            <img src="../../img/thumbcache-thumbcacheviewer.png" class="img-fluid">
            <br>
            <br>
            You may have noticed that the file name isn't an a human readable format. To remedy that, Thumbcache Viewer has a feature we can take adavantage that cross references the Windows Search database in order to map the file paths of images within the Thumbcache database. The Windows Search database is located at <strong>C:\ProgramData\Microsoft\Search\Data\Applications\Windows\Windows.edb</strong>. After exporting the C:\ProgramData\Microsoft\Search\Data\Applications\Windows\ directory, the Windows.ebd database is considered to be in a <em>dirty</em> state. We can resolve that by using <strong>esentutl</strong>, a built-in Mirosoft utility for working with ESE databases. In a command prompt windows, navigate to the Windows.ebd directory and run <strong>esentutl /r edb /d</strong>.
            <br>
            <br>
            <img src="../../img/thumbcache-esentutl.gif" class="img-fluid">
            <br>
            <br>
            Now that we've repaired the Windows Search database, we can return to Thumbcache Viewer and select <strong>Map File Paths...</strong> from the Tools dropdown menu. Alternatively we can also use the <kbd>Ctrl + M</kbd> keyboard shortcut. Select <strong>Load ESE Database</strong> and point it to your repaired database. Select <strong>Scan</strong> to start the analysis.
            <br>
            <br>
            <img src="../../img/thumbcache-thumbcacheviewer-map-file-paths.png" class="img-fluid">
            <br>
            <br>
            Thumbcache will now display the file names and paths for the images it was able to succesfully identify in the Windows Search database. In the example below, it was able to successfully map out the full path of the files that still exist on my file system. The other images have already been deleted. Highlighting the potential for referencing thumbcache databases to get a glimpse into what files might have previously existing on an endpoint.
            <br>
            <br>
            <img src="../../img/thumbcache-thumbcacheviewer-mapped-file-paths.png" class="img-fluid">
            <br>
            <br>
          </p>
        </div>
      </div>
      <div class="col-lg-2 text-left"></div>
    </div>
  </div>
  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
    integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
    integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
    crossorigin="anonymous"></script>

</body>

</html>